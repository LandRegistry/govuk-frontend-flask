{% extends "base.html" %}

{%- from 'govuk_frontend_jinja/components/breadcrumbs/macro.html' import govukBreadcrumbs -%}

{% block pageTitle %}{%- if form.errors %}Error: {% endif -%}Conditionally revealed inputs â€“ GOV.UK{% endblock %}

{% block beforeContent %}
  {{ super() }}
  {{ govukBreadcrumbs({
    'collapseOnMobile': True,
    'items': [
        {
            'text': "Home",
            'href': url_for('main.index')
        },
        {
            'text': "Forms",
            'href': url_for('demos.forms')
        },
        {
            'text': "Conditional reveal"
        }
    ]
  }) }}
{% endblock %}

{% block content %}
<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    {{ super() }}
    <span class="govuk-caption-xl">Demo form</span>
    <h1 class="govuk-heading-xl">Conditionally revealed inputs</h1>

    <form action="" method="post" novalidate>
      {{ form.csrf_token }}

      <!-- Grab html for conditional fields -->
      {% set emailHtml %}
        {{ form.contact_by_email(params={
          'type': 'email',
          'autocomplete': 'email',
          'spellcheck': false,
          'classes': 'govuk-!-width-one-third'
        }) }}
      {% endset %}

      {% set phoneHtml %}
        {{ form.contact_by_phone(params={
          'type': 'tel',
          'autocomplete': 'tel',
          'classes': 'govuk-!-width-one-third'
        }) }}
      {% endset %}

      {% set textHtml %}
        {{ form.contact_by_text(params={
          'type': 'tel',
          'autocomplete': 'tel',
          'classes': 'govuk-!-width-one-third'
        }) }}
      {% endset %}

      <!--
      Render the radio buttons
      The conditional field html is passed in via the params argument which is 
      deep merged into the params generated by govuk-frontend-wtf.
      
      This is the same structure that is documented on the govuk design system.
      https://design-system.service.gov.uk/components/radios/#conditionally-revealing-a-related-question
      
      The field definition in ConditionalRevealForm has three options.
      Therefore we have an array of three items here to match.
      -->
      {{ form.contact(params={
        'items': [
          {
            'conditional': {
              'html': emailHtml
            }
          },
          {
            'conditional': {
              'html': phoneHtml
            }
          },
          {
            'conditional': {
              'html': textHtml
            }
          }
        ]
      }) }}      

      {{ form.submit }}
    </form>
  </div>
</div>
{% endblock %}
